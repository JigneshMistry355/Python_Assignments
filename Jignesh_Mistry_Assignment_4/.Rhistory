knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(dplyr)
library(ggplot2)
library(lubridate)
weather_data <- read.csv("weather_data.csv")
# Display first few rows
head(weather_data)
# Display column names
colnames(weather_data)
# Check for missing values
sum(is.na(weather_data))
# Convert Date_Time to Date format
weather_data$Date_Time <- as.Date(weather_data$Date_Time)
# Filter only 3 cities (already only 3 in dataset, but let's keep code generic)
selected_cities <- c("Mumbai", "Delhi", "Bangalore")
weather_data <- weather_data %>% filter(Location %in% selected_cities)
# Create new column: Temperature in Fahrenheit
weather_data <- weather_data %>% mutate(Temperature_F = Temperature_C * 9/5 + 32)
# Calculate weekly averages
weather_data <- weather_data %>% mutate(Week = isoweek(Date_Time))
weekly_avg <- weather_data %>% group_by(Location, Week) %>%
summarise(Avg_Temp = mean(Temperature_C),
Avg_Humidity = mean(Humidity_pct),
Avg_Rainfall = mean(Precipitation_mm),
.groups = "drop")
head(weekly_avg)
# Hottest and coldest city based on average temperature
city_avg_temp <- weather_data %>% group_by(Location) %>% summarise(Mean_Temp = mean(Temperature_C))
hottest_city <- city_avg_temp %>% filter(Mean_Temp == max(Mean_Temp))
coldest_city <- city_avg_temp %>% filter(Mean_Temp == min(Mean_Temp))
hottest_city
coldest_city
# Day with highest rainfall per city
highest_rainfall <- weather_data %>% group_by(Location) %>%
filter(Precipitation_mm == max(Precipitation_mm)) %>% arrange(Location)
highest_rainfall
# Compare average humidity levels between cities
avg_humidity <- weather_data %>% group_by(Location) %>% summarise(Mean_Humidity = mean(Humidity_pct))
avg_humidity
# 1. Line graph - Temperature trends
ggplot(weather_data, aes(x = Date_Time, y = Temperature_C, color = Location)) +
geom_line(size = 1) +
labs(title = "Daily Temperature Trends", x = "Date", y = "Temperature (Â°C)") +
theme_minimal()
# 2. Bar plot - Weekly average rainfall comparison
ggplot(weekly_avg, aes(x = factor(Week), y = Avg_Rainfall, fill = Location)) +
geom_bar(stat="identity", position = "dodge") +
labs(title = "Weekly Average Rainfall", x = "Week", y = "Rainfall (mm)") +
theme_minimal()
# 3. Boxplot - Humidity distribution across cities
ggplot(weather_data, aes(x = Location, y = Humidity_pct, fill = Location)) +
geom_boxplot() +
labs(title = "Humidity Distribution Across Cities", x = "City", y = "Humidity (%)") +
theme_minimal()
